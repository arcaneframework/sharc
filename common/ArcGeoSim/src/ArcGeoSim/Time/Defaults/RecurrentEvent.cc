// -*- tab-width: 2; indent-tabs-mode: nil; coding: utf-8-with-signature -*-
//-----------------------------------------------------------------------------
// Copyright 2000-2022 CEA (www.cea.fr) IFPEN (www.ifpenergiesnouvelles.com)
// See the top-level COPYRIGHT file for details.
// SPDX-License-Identifier: Apache-2.0
//-----------------------------------------------------------------------------
#include "RecurrentEvent.h"
/* Author : desrozis at Thu Oct 30 16:54:25 2014
 * Generated by createNew
 */

#ifdef WIN32
#include <ciso646>
#endif

#include "ArcGeoSim/Time/Observer/IObservable.h"

/*---------------------------------------------------------------------------*/
/*---------------------------------------------------------------------------*/

BEGIN_ARCGEOSIM_NAMESPACE

/*---------------------------------------------------------------------------*/
/*---------------------------------------------------------------------------*/

RecurrentEvent::
RecurrentEvent(Arcane::String name,
               Arcane::Real date,
               Arcane::Integer entry_points,
               Arcane::Integer types)
  : EventBasics(name,date,entry_points,types)
{
  if(not (types & Recurrent))
    fatal() << "ArcGeoSim::RecurrentEvent is suitable for reccurent events";
}

/*---------------------------------------------------------------------------*/

RecurrentEvent::
RecurrentEvent(Arcane::String name,
               Arcane::Real start_date,
               Arcane::Real end_date,
               Arcane::Integer entry_points,
               Arcane::Integer types)
  : EventBasics(name,start_date,end_date,entry_points,types)
{
  if(not (types & Recurrent))
    fatal() << "ArcGeoSim::Event is suitable for reccurent events";
}

/*---------------------------------------------------------------------------*/

void
RecurrentEvent::
notify(eTimeStepState state)
{
  switch(state) {
  case TimeStepIsFinished:
    if(startDate() > m_time_n()) return;
    if(endDate() > m_time()) return;
    reschedule();
    break;
  case TimeStepIsRestored:
    break;
  default:
    fatal() << "Time step type is not defined";
  }
}

/*---------------------------------------------------------------------------*/
/*---------------------------------------------------------------------------*/

END_ARCGEOSIM_NAMESPACE

/*---------------------------------------------------------------------------*/
/*---------------------------------------------------------------------------*/
