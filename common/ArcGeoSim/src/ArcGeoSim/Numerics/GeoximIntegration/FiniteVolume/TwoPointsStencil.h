// -*- C++ -*-
#ifndef ARCGEOSIM_NUMERICS_FINITEVOLUME_TWOPOINTSSTENCIL_H
#define ARCGEOSIM_NUMERICS_FINITEVOLUME_TWOPOINTSSTENCIL_H
/* Author : desrozis at Wed Sep  4 10:21:36 2013
 * Generated by createNew
 */

#include "ArcGeoSim/Utils/ArcGeoSim.h"
#include "ArcGeoSim/Physics/Law2/Contribution/Item.h"

#include "ArcGeoSim/Mesh/Utils/IXMTools/IXMItemConnections.h"

/*---------------------------------------------------------------------------*/
/*---------------------------------------------------------------------------*/

namespace ArcNum {

/*---------------------------------------------------------------------------*/
/*---------------------------------------------------------------------------*/

class TwoPointsStencil
{
public:
  
  TwoPointsStencil(Arcane::Face face)
    : m_back (face.backCell() , 2, 0)
    , m_front(face.frontCell(), 2, 1) 
  {
    ARCANE_ASSERT((not face.isSubDomainBoundary()),("Face is boundary"));
  }

  TwoPointsStencil(Arcane::ItemEnumeratorT<Arcane::Face> face)
    : m_back (face->backCell() , 2, 0)
    , m_front(face->frontCell(), 2, 1) 
  {
    ARCANE_ASSERT((not face->isSubDomainBoundary()),("Face is boundary"));
  }

#if (ARCANE_VERSION >= 30003)
  TwoPointsStencil(ArcGeoSim::FaceFaceConnectionEnumerator faceface_connection,Arcane::IGraph2* graph)
  {
    const Arcane::Face first_face  = faceface_connection->first(graph);
    const Arcane::Face second_face = faceface_connection->second(graph);
    _buildBackAndFrontCellsFromConnection(first_face,second_face);
  }
#else
  TwoPointsStencil(ArcGeoSim::FaceFaceConnectionEnumerator faceface_connection)
  {
    const Arcane::Face first_face  = faceface_connection->first();
    const Arcane::Face second_face = faceface_connection->second();
    _buildBackAndFrontCellsFromConnection(first_face,second_face);
  }
#endif

#if (ARCANE_VERSION >= 30003)
  TwoPointsStencil(ArcGeoSim::FaceFaceConnection faceface_connection,Arcane::IGraph2* graph)
  {
    const Arcane::Face first_face  = faceface_connection.first(graph);
    const Arcane::Face second_face = faceface_connection.second(graph);
    _buildBackAndFrontCellsFromConnection(first_face,second_face);
  }
#else
  TwoPointsStencil(ArcGeoSim::FaceFaceConnection faceface_connection)
  {
    const Arcane::Face first_face  = faceface_connection.first();
    const Arcane::Face second_face = faceface_connection.second();
    _buildBackAndFrontCellsFromConnection(first_face,second_face);
  }
#endif

  const Law::Cell& back() const
  {
    return m_back;
  }
  const Law::Cell& front() const
  {
    return m_front;
  }
  
private:
  
  void _buildBackAndFrontCellsFromConnection(const Arcane::Face& first_face, const Arcane::Face& second_face)
  {
    ARCANE_ASSERT((first_face.isSubDomainBoundary() && second_face.isSubDomainBoundary()),("Face connection (for fault) should not be between internal faces."))
    // Construction des back et front
    m_back  = Law::Cell(first_face.boundaryCell(),  2, 0);
    m_front = Law::Cell(second_face.boundaryCell(), 2, 1);
  }

private:

  Law::Cell m_back;
  Law::Cell m_front;
};

/*---------------------------------------------------------------------------*/
/*---------------------------------------------------------------------------*/

}

/*---------------------------------------------------------------------------*/
/*---------------------------------------------------------------------------*/

#endif /* ARCGEOSIM_NUMERICS_FINITEVOLUME_TWOPOINTSSTENCIL_H */
