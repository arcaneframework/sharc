// -*- C++ -*-
#ifndef ARCGEOSIM_NUMERICS_EXPRESSIONS_UNSTEADYREGULARGRIDDATA_ONEPOINTINTERPGRIDDATAFUNCTION_ONEPOINTGRIDDATAINTERPOLATOR_H
#define ARCGEOSIM_NUMERICS_EXPRESSIONS_UNSTEADYREGULARGRIDDATA_ONEPOINTINTERPGRIDDATAFUNCTION_ONEPOINTGRIDDATAINTERPOLATOR_H
/* Author : dechaiss at Thu Apr 22 16:27:27 2010
 * Generated by createNew
 */

#include <arcane/utils/UtilsTypes.h>
#include <arcane/utils/Array.h>
using namespace Arcane;

class OnePointGridDataInterpolator
{
public:
  /** Constructeur de la classe */
  OnePointGridDataInterpolator()
    {
      ;
    }

  /** Destructeur de la classe */
  virtual ~OnePointGridDataInterpolator() {}

public:

  /** interpolation method */
  inline static Real interpolate(const Array<Real>& interp_point_coordinates, Array<Integer>& lower_limit_grid_point_indexes,
                                 const Array<Real>& grid_x, const Array<Real>& grid_y,
                                 const Array<Real>& grid_z, const Array<Real>& grid_t,
                                 const Array<Real>& property, const Array<Integer>& size)
    {
    	
	for (int i=0;i<4;i++)
	  {
		if (lower_limit_grid_point_indexes[i] == -1)
		 	lower_limit_grid_point_indexes[i] = 0;	  
		else
		   if (lower_limit_grid_point_indexes[i] == size[i])
			lower_limit_grid_point_indexes[i] = size[i]-1;
	  }
      // Constant interpolation: return closer point
      return property[size[0] * size[1] * size[2] * lower_limit_grid_point_indexes[3] + size[0] * size[1]
          * lower_limit_grid_point_indexes[2] + size[0] * lower_limit_grid_point_indexes[1]
          + lower_limit_grid_point_indexes[0]];
    }

};

#endif /* ARCGEOSIM_NUMERICS_EXPRESSIONS_UNSTEADYREGULARGRIDDATA_ONEPOINTINTERPGRIDDATAFUNCTION_ONEPOINTGRIDDATAINTERPOLATOR_H */
