// -*- tab-width: 2; indent-tabs-mode: nil; coding: utf-8-with-signature -*-
//-----------------------------------------------------------------------------
// Copyright 2000-2025 CEA (www.cea.fr) IFPEN (www.ifpenergiesnouvelles.com)
// See the top-level COPYRIGHT file for details.
// SPDX-License-Identifier: Apache-2.0
//-----------------------------------------------------------------------------
// -*- C++ -*-
#ifndef ARCGEOSIM_ARCGEOSIM_NUMERICS_LINEARALGEBRA2_INDEXMANAGER_SIMPLEABSTRACTFAMILY_H
#define ARCGEOSIM_ARCGEOSIM_NUMERICS_LINEARALGEBRA2_INDEXMANAGER_SIMPLEABSTRACTFAMILY_H
/* Author : havep at Mon Jan 14 18:30:40 2013
 * Generated by createNew
 */



#include "ArcGeoSim/Numerics/AlienTools/IIndexManager.h"
#include <arcane/utils/FatalErrorException.h>
#include <arcane/IParallelMng.h>

/*---------------------------------------------------------------------------*/

BEGIN_ALIEN_NAMESPACE

/*---------------------------------------------------------------------------*/

/* Dans cette impl�mentation, implicitement le localId du i_�me item est i */
class SimpleAbstractFamily 
  : public IIndexManager::IAbstractFamily {
public:
  //! Construit une famille � partir des uniqueIds connus localement et leur propri�taire
  /*! L'indexation localId suit l'ordre des uniqueIds fournis */
  SimpleAbstractFamily(const Arcane::Int64ConstArrayView uniqueIds,
                       const Arcane::IntegerConstArrayView owners,
                       IIndexManager * manager);

  //! Construit une famille � partir des uniqueIds locaux
  /*! Les items locaux sont index�s en premier, puis suivent ceux des autres processeurs. 
   *  Les propri�taires sont reconstruits en parall�le */
  SimpleAbstractFamily(const Arcane::Int64ConstArrayView uniqueIds,
                       IIndexManager * manager);
  
  virtual ~SimpleAbstractFamily();
  
public:
  IIndexManager::IAbstractFamily * clone() const { return new SimpleAbstractFamily(*this); }

public:
  Int32 maxLocalId() const { return m_unique_ids.size(); }
  void uniqueIdToLocalId(Arcane::Int32ArrayView localIds, Arcane::Int64ConstArrayView uniqueIds) const;
  IAbstractFamily::Item item(Int32 localId) const;
  SafeConstArrayView<Integer> owners(Arcane::Int32ConstArrayView localIds) const;
  SafeConstArrayView<Int64> uids(Arcane::Int32ConstArrayView localIds) const;
  SafeConstArrayView<Int32> allLocalIds() const;
  
private:
  IIndexManager * m_manager;
  Arcane::Int64SharedArray m_unique_ids;
  Arcane::IntegerSharedArray m_owners;
};

/*---------------------------------------------------------------------------*/

END_ALIEN_NAMESPACE

/*---------------------------------------------------------------------------*/

#endif /* ARCGEOSIM_ARCGEOSIM_NUMERICS_LINEARALGEBRA2_INDEXMANAGER_SIMPLEABSTRACTFAMILY_H */
