#ifndef ARCGEOSIM_NUMERICS_NONLINEARSOLVER_NONLINEARSYSTEMBUILDERT_H
#define ARCGEOSIM_NUMERICS_NONLINEARSOLVER_NONLINEARSYSTEMBUILDERT_H
/* Author : gratienj at Fri Mar 27 12:19:59 2009
 * Generated by createNew
 */

#include "ArcGeoSim/Utils/VisitorT.h"

using namespace Arcane;
class INonLinearSystemVisitor;
class INonLinearSystemBuilder;

template<typename NonLinearSystemType>
class NonLinearSystemBuilderT 
  : public INonLinearSystemVisitor
  , public INonLinearSystemBuilder
  , public VisitorT<NonLinearSystemType>
{
public:
  /** Constructeur de la classe */
  NonLinearSystemBuilderT() 
  {
   ;
  }
  
  /** Destructeur de la classe */
  virtual ~NonLinearSystemBuilderT() { }
  
  //! Getting operator name
  // Is it name or kind of operator ?
  String name() const { return "NonLinearSystemBuilderT"; }
 
  //! Initialisation
  void init() { m_initialized = true; }
  
  //! Initializing the system 
  void start(INonLinearSystem * non_linear_system) {}
  
  //! Finalizing the system
  void end(INonLinearSystem * non_linear_system) {}

  //! Computing at the begin of the iterative step 
  void startStep(INonLinearSystem * non_linear_system) 
  {
    non_linear_system->startStep();
  }
  
  //! Computing at the end of the iterative step
  void endStep(INonLinearSystem * non_linear_system) 
  {
    non_linear_system->endStep();
    non_linear_system->buildLinearSystem() ;
  }
  
  INonLinearSystemVisitor* asNonLinearSystemVisitor() 
  {
    return this;
  }
  
  //! Building non linear system
  Integer buildNonLinearSystem(INonLinearSystem * non_linear_system) 
  {
    return non_linear_system->accept(asNonLinearSystemVisitor());
  }
 
  //! Visiting non linear system
  // INonLinearSystemVisitor method
  Integer visit(NonLinearSystemType* system) 
  {
    return system->buildLinearizedSystem();
  }
  
private :
  
  bool m_initialized;
};

#endif /* ARCGEOSIM_NUMERICS_NONLINEARSOLVER_INONLINEARSYSTEMBUILDER_H */
