// -*- C++ -*-
/* Author : havep at Tue Aug 21 10:46:30 2012
 * Generated by createNew
 */
#include "petscversion.h"

/*---------------------------------------------------------------------------*/
#if ((PETSC_VERSION_MAJOR >= 3 && PETSC_VERSION_MINOR >= 3) || (PETSC_VERSION_MAJOR > 3))
/*---------------------------------------------------------------------------*/

#include "ArcGeoSim/Numerics/LinearAlgebra2/PETScImpl/PETScPrecomp.h"
#include "ArcGeoSim/Numerics/LinearSolver/PETScSolverImpl/FieldSplit/IFieldSplitType.h"
#include "SchurFieldSplitType_axl.h"

/*---------------------------------------------------------------------------*/
/*---------------------------------------------------------------------------*/

//BEGIN_LINEARALGEBRA2SERVICE_NAMESPACE

/*---------------------------------------------------------------------------*/
/*---------------------------------------------------------------------------*/

class SchurFieldSplitTypeService 
  : public ArcaneSchurFieldSplitTypeObject
{
public:
  
  /** Constructeur de la classe */
  SchurFieldSplitTypeService(const Arcane::ServiceBuildInfo & sbi) 
    : ArcaneSchurFieldSplitTypeObject(sbi) {}
  
  /** Destructeur de la classe */
  ~SchurFieldSplitTypeService() {}
  
public:

  //! Configure FieldSplit type
  virtual int configure(PC & pc, const Integer nbField);
};

/*---------------------------------------------------------------------------*/
/*---------------------------------------------------------------------------*/

int
SchurFieldSplitTypeService::
configure(PC & pc, const Integer nbField)
{
  if (nbField != 2)
    fatal() << "FieldSplit Schur decomposition can be applied only on 2 blocks decompositions";

  int code = 0;
  code += PCFieldSplitSetType(pc, PC_COMPOSITE_SCHUR);
  code += PCFieldSplitSetSchurFactType(pc, options()->offDiagonalApproximation());
  return code;
}

/*---------------------------------------------------------------------------*/
/*---------------------------------------------------------------------------*/

using namespace Arcane;
ARCANE_REGISTER_SERVICE_SCHURFIELDSPLITTYPE(Schur,SchurFieldSplitTypeService);

/*---------------------------------------------------------------------------*/
/*---------------------------------------------------------------------------*/

//END_LINEARALGEBRA2SERVICE_NAMESPACE

/*---------------------------------------------------------------------------*/
/*---------------------------------------------------------------------------*/

/*---------------------------------------------------------------------------*/
#endif /* PETSC_VERSION */
/*---------------------------------------------------------------------------*/
