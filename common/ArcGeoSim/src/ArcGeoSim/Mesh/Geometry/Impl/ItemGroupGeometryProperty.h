#ifndef ARCGEOSIM_GEOMETRY_IMPL_ITEMGROUPGEOMETRYPROPERTY_H
#define ARCGEOSIM_GEOMETRY_IMPL_ITEMGROUPGEOMETRYPROPERTY_H
/* Author : havep at Tue Apr  1 17:25:52 2008
 * Generated by createNew
 */

#include "ArcGeoSim/Mesh/Geometry/IGeometryMng.h"
#include <memory>

//! Internal class implementation for TemisGeometryService and Euclidian3GeometryService
class ItemGroupGeometryProperty
{
public:
  /** Constructeur de la classe */
  ItemGroupGeometryProperty();

  /** Destructeur de la classe */  
  virtual ~ItemGroupGeometryProperty();
public:

  struct StorageInfo {
    StorageInfo() : storageType(0), externStorage(0), ownStorage(0), usageVarCount(0), usageMapCount(0), context(-1) { }
    Integer storageType;
    Integer externStorage;
    Integer ownStorage;
    UInt32 usageVarCount;
    UInt32 usageMapCount;
    Int64 context;
    std::shared_ptr<IGeometryMng::RealVariable> realVar;
    std::shared_ptr<IGeometryMng::Real3Variable> real3Var;
    std::shared_ptr<IGeometryMng::RealGroupMap> realMap;
    std::shared_ptr<IGeometryMng::Real3GroupMap> real3Map;
  };

  typedef std::map<IGeometryProperty::eProperty, StorageInfo> StorageInfos;

  Integer defined; //!< Toutes les propriétés définies sur ce groupe
  StorageInfos storages; //!< Toutes les propriétés et leurs conteneurs

  bool hasProperty(const IGeometryProperty::eProperty p) const;
  Integer getStorage(const IGeometryProperty::eProperty p) const;
};



//! Modéle générique (vide) des accès de StorageInfo par type de stockage
template<typename T>
class ContainerAccessorT { };

template<>
struct ContainerAccessorT<Real> {
  typedef IGeometryMng::RealVariable RealTVariable;
  typedef IGeometryMng::RealGroupMap RealTGroupMap;
  inline static std::shared_ptr<RealTVariable> & getVarContainer(ItemGroupGeometryProperty::StorageInfo & storage) { return storage.realVar; }
  inline static std::shared_ptr<RealTGroupMap> & getMapContainer(ItemGroupGeometryProperty::StorageInfo & storage) { return storage.realMap; }
};

template<>
struct ContainerAccessorT<Real3> {
  typedef IGeometryMng::Real3Variable RealTVariable;
  typedef IGeometryMng::Real3GroupMap RealTGroupMap;
  inline static std::shared_ptr<RealTVariable> & getVarContainer(ItemGroupGeometryProperty::StorageInfo & storage) { return storage.real3Var; }
  inline static std::shared_ptr<RealTGroupMap> & getMapContainer(ItemGroupGeometryProperty::StorageInfo & storage) { return storage.real3Map; }
};

#endif /* ARCGEOSIM_GEOMETRY_IMPL_ITEMGROUPGEOMETRYPROPERTY_H */
